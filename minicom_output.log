 
'
> go  
> <INTERRUPT>
Phytium-Pi#go 0x90100000
## Starting application at 0x90100000 ...
aaaaaaaaaaaacarch = aarch64
platform = aarch64-phytium-pi
target = aarch64-unknown-none-softfloat
smp = 1
build_mode = release
log_level = debug

ccc[ 37.542388 0 axruntime:138] Logging is enabled.
[ 37.548117 0 axruntime:139] Primary CPU 512 started, dtb = 0x1.
[ 37.555234 0 axruntime:141] Found physcial memory regions:
c[ 37.562005 0 axruntime:144]   [PA:0x90100000, PA:0x9011f000) .text (READ | EXECUTE | RESERVED)
[ 37.571813 0 axruntime:144]   [PA:0x9011f000, PA:0x90127000) .rodata (READ | RESERVED)
[ 37.580927 0 axruntime:144]   [PA:0x90127000, PA:0x9012b000) .data .tdata .tbss .percpu (READ | WRITE | RESERVED)
[ 37.592384 0 axruntime:144]   [PA:0x9012b000, PA:0x9016b000) boot stack (READ | WRITE | RESERVED)
[ 37.602453 0 axruntime:144]   [PA:0x9016b000, PA:0x90190000) .bss (READ | WRITE | RESERVED)
[ 37.612001 0 axruntime:144]   [PA:0x0, PA:0x1000) spintable (READ | WRITE | RESERVED)
[ 37.621029 0 axruntime:144]   [PA:0x90190000, PA:0x90490000) nocache memory (READ | WRITE | DEVICE)
[ 37.631271 0 axruntime:144]   [PA:0x90490000, PA:0xffd00000) free memory (READ | WRITE | FREE)
[ 37.641079 0 axruntime:144]   [PA:0x2800c000, PA:0x2800d000) mmio (READ | WRITE | DEVICE | RESERVED)
[ 37.651409 0 axruntime:144]   [PA:0x2800d000, PA:0x2800e000) mmio (READ | WRITE | DEVICE | RESERVED)
[ 37.661738 0 axruntime:144]   [PA:0x2800e000, PA:0x2800f000) mmio (READ | WRITE | DEVICE | RESERVED)
[ 37.672067 0 axruntime:144]   [PA:0x2800f000, PA:0x28010000) mmio (READ | WRITE | DEVICE | RESERVED)
[ 37.682396 0 axruntime:144]   [PA:0x30000000, PA:0x38000000) mmio (READ | WRITE | DEVICE | RESERVED)
[ 37.692725 0 axruntime:144]   [PA:0x40000000, PA:0x50000000) mmio (READ | WRITE | DEVICE | RESERVED)
[ 37.703055 0 axruntime:223] Initialize global memory allocator...
[ 37.710346 0 axruntime:224]   use TLSF allocator.
[ 37.716250 0 axalloc:281] initialize global allocator at: free-[0xffff000090490000, 0xffff0000ffd00000)
[ 37.727162 0 axruntime:158] Initialize kernel page table...
[ 37.733707 0 axruntime:258] Initialize global no cache memory allocator...
[ 37.741682 0 axalloc:297] initialize global allocator at: nocache-[0x90190000,0x90490000)
[ 37.751057 0 axruntime:165] Initialize platform devices...
[ 37.757738 0 axtask::api:66] Initialize scheduling...
[ 37.763993 0 axtask::task:146] new task: Task(1, "idle")
[ 37.770502 0 axtask::task:146] new task: Task(3, "gc")
[ 37.776838 0 axalloc:126] expand heap memory: [0xffff0000904a3000, 0xffff0000904e3000)
[ 37.785955 0 axalloc:126] expand heap memory: [0xffff0000904e3000, 0xffff000090563000)
[ 37.795064 0 axtask::api:72]   use FIFO scheduler.
[ 37.801052 0 axdriver:158] Initialize device drivers...
[ 37.807475 0 axdriver:159]   device model: static
[ 37.813377 0 driver_pci::phytium:18] PCIe link start @0xFFFF000040000000...
[ 37.821536 0 driver_pci::phytium:19] theroticly, since uboot had already initialized it, we need't to operate it any more!
[ 37.833776 0 axdriver::bus::pci:14] probing in pci.rs!
[ 37.840112 0 driver_pci::root_complex:96] into next!
[ 37.846275 0 driver_pci::root_complex:98] looped
[ 37.852091 0 driver_pci::root_complex:98] looped
[ 37.857906 0 driver_pci::root_complex:98] looped
[ 37.863722 0 driver_pci::root_complex:98] looped
[ 37.869537 0 driver_pci::root_complex:98] looped
[ 37.875353 0 driver_pci::root_complex:98] looped
[ 37.881168 0 driver_pci::root_complex:98] looped
[ 37.886984 0 driver_pci::root_complex:98] looped
[ 37.892800 0 driver_pci::root_complex:98] looped
[ 37.898615 0 driver_pci::root_complex:98] looped
[ 37.904431 0 driver_pci::root_complex:98] looped
[ 37.910246 0 driver_pci::root_complex:98] looped
[ 37.916062 0 driver_pci::root_complex:98] looped
[ 37.921878 0 driver_pci::root_complex:98] looped
[ 37.927693 0 driver_pci::root_complex:98] looped
[ 37.933509 0 driver_pci::root_complex:98] looped
[ 37.939325 0 driver_pci::root_complex:98] looped
[ 37.945140 0 driver_pci::root_complex:98] looped
[ 37.950956 0 driver_pci::root_complex:98] looped
[ 37.956771 0 driver_pci::root_complex:98] looped
[ 37.962587 0 driver_pci::root_complex:98] looped
[ 37.968402 0 driver_pci::root_complex:98] looped
[ 37.974218 0 driver_pci::root_complex:98] looped
[ 37.980034 0 driver_pci::root_complex:98] looped
[ 37.985849 0 driver_pci::root_complex:98] looped
[ 37.991665 0 driver_pci::root_complex:98] looped
[ 37.997481 0 driver_pci::root_complex:98] looped
[ 38.003296 0 driver_pci::root_complex:98] looped
[ 38.009112 0 driver_pci::root_complex:98] looped
[ 38.014927 0 driver_pci::root_complex:98] looped
[ 38.020743 0 driver_pci::root_complex:98] looped
[ 38.026558 0 driver_pci::root_complex:98] looped
[ 38.032374 0 driver_pci::root_complex:98] looped
[ 38.038190 0 driver_pci::root_complex:116] none!
[ 38.044005 0 axdriver:190] number of usb host controller: 0
[ 38.050776 0 axruntime:201] Primary CPU 512 init OK.
Available commands:
  exit
  help
  uname
  ldr
  str
  test_xhci
arceos# test_xhci
[ 39.940155 0:2 driver_usb::host::xhci:49] resetting xhci controller
[ 39.944916 0:2 driver_usb::host::xhci:50] before reset:UsbStatusRegister { hc_halted: false, host_system_error: false, event_interrupt: false, port_change_detect: true, save_state_status: false, restore_state_status: false, save_restore_error: false, controller_not_ready: false, host_controller_error: false }
[ 39.973473 0:2 driver_usb::host::xhci:144] stop
[ 39.979202 0:2 driver_usb::host::xhci:149] wait until halt
[ 39.985886 0:2 driver_usb::host::xhci:151] halted
[ 39.991788 0:2 driver_usb::host::xhci:153] HCRST!
[ 39.997692 0:2 driver_usb::host::xhci:179] Reset xHCI Controller Globally
[ 40.005680 0:2 driver_usb::host::structures::xhci_slot_manager:78] max slot: 0
[ 40.014097 0:2 driver_usb::host::structures::xhci_slot_manager:90] initialized!
[ 40.022602 0:2 driver_usb::host::structures::xhci_event_manager:43] initilizating!
[ 40.031402 0:2 driver_usb::host::structures::event_ring:33] created!
[ 40.038921 0:2 driver_usb::host::structures::xhci_event_manager:56] test
[ 40.046824 0:2 driver_usb::host::structures::xhci_event_manager:101] initialized!
[ 40.055535 0:2 driver_usb::host::structures::xhci_command_manager:218] initialized!
[ 40.064361 0:2 driver_usb::host::structures::scratchpad:54] initialized!
[ 40.072252 0:2 driver_usb::host::structures::scratchpad:60] initialized!
[ 40.080152 0:2 driver_usb::host::structures::xhci_roothub:235] number of ports:2
[ 40.088744 0:2 driver_usb::host::structures::xhci_roothub:240] allocating port 0
[ 40.097338 0:2 driver_usb::host::structures::xhci_roothub:253] assert:0 == 0
[ 40.105583 0:2 driver_usb::host::structures::xhci_roothub:240] allocating port 1
[ 40.114176 0:2 driver_usb::host::structures::xhci_roothub:253] assert:1 == 1
[ 40.122423 0:2 driver_usb::host::structures::xhci_roothub:267] initialized!
[ 40.130581 0:2 driver_usb::host::xhci:66] before start:UsbStatusRegister { hc_halted: true, host_system_error: false, event_interrupt: false, port_change_detect: true, save_state_status: false, restore_state_status: false, save_restore_error: false, controller_not_ready: false, host_controller_error: false }
[ 40.159052 0:2 driver_usb::host::xhci:77] init completed!, coltroller state:UsbStatusRegister { hc_halted: false, host_system_error: false, event_interrupt: false, port_change_detect: true, save_state_status: false, restore_state_status: false, save_restore_error: false, controller_not_ready: false, host_controller_error: false }
[ 40.189434 0:2 driver_usb::host::xhci:86] port0 : false
[ 40.195856 0:2 driver_usb::host::xhci:86] port1 : true
[ 40.202191 0:2 driver_usb::host::xhci:113] initializing roothub
[ 40.209309 0:2 driver_usb::host::structures::xhci_roothub:164] initializing root ports
[ 40.218423 0:2 driver_usb::host::structures::xhci_roothub:169] initializing port 0
[ 40.227192 0:2 driver_usb::host::structures::xhci_roothub:36] port 0 not connected
[ 40.235956 0:2 driver_usb::host::structures::xhci_roothub:169] initializing port 1
[ 40.244725 0:2 driver_usb::host::structures::xhci_roothub:39] port 1 connected, continue
[ 40.254012 0:2 driver_usb::host::structures::xhci_roothub:50] waiting for port reset!
[ 40.263039 0:2 driver_usb::host::structures::xhci_roothub:63] port 1 reset!
[ 40.271199 0:2 driver_usb::host::structures::xhci_roothub:69] port speed: USBSpeedSuper
[ 40.280398 0:2 driver_usb::host::structures::xhci_roothub:71] initializing device: USBSpeedSuper
[ 40.290380 0:2 driver_usb::host::structures::xhci_usb_device:38] new device! port:1
[ 40.299234 0:2 driver_usb::host::structures::xhci_command_manager:107] do command EnableSlot(EnableSlot { slot_type: 0, cycle_bit: false }) !
[ 40.313123 0:2 driver_usb::host::structures::xhci_command_manager:122] waiting for interrupt handler complete!
[ 40.324321 0:2 driver_usb::host::structures::xhci_event_manager:111] event handler has a trb:PortStatusChange(PortStatusChange { completion_code: Ok(Success), port_id: 2, cycle_bit: true })
[ 40.342373 0:2 driver_usb::host::structures::xhci_event_manager:141] step into port status change.

[ 40.352703 0:2 driver_usb::host::structures::xhci_roothub:110] port 1 status changed
[ 40.361644 0:2 driver_usb::host::structures::xhci_event_manager:111] event handler has a trb:PortStatusChange(PortStatusChange { completion_code: Ok(Success), port_id: 2, cycle_bit: true })
[ 40.379697 0:2 driver_usb::host::structures::xhci_event_manager:141] step into port status change.

[ 40.390026 0:2 driver_usb::host::structures::xhci_roothub:110] port 1 status changed
[ 40.398968 0:2 driver_usb::host::structures::xhci_event_manager:111] event handler has a trb:CommandCompletion(CommandCompletion { completion_code: Ok(Success), command_trb_pointer: 2417577984, command_completion_parameter: 0, vf_id: 0, slot_id: 1, cycle_bit: true })
[ 40.423792 0:2 driver_usb::host::structures::xhci_event_manager:136] step into command completion.

[ 40.434121 0:2 driver_usb::host::structures::xhci_command_manager:176] handleing command complete:CommandCompletion { completion_code: Ok(Success), command_trb_pointer: 2417577984, command_completion_parameter: 0, vf_id: 0, slot_id: 1, cycle_bit: true }
[ 40.457730 0:2 driver_usb::host::structures::xhci_command_manager:128] t o t a l success!
[ 40.467105 0:2 driver_usb::host::structures::xhci_usb_device:42] enable slot success!
[ 40.476192 0:2 driver_usb::host::structures::xhci_roothub:74] writing ...
[ 40.484118 0:2 driver_usb::host::structures::xhci_usb_device:85] init input ctx
[ 40.494642 0:2 driver_usb::host::structures::xhci_usb_device:113] begin config endpoint 0 and assign dev!
[ 40.503389 0:2 driver_usb::host::structures::xhci_usb_device:117] config ep0
[ 40.513652 0:2 driver_usb::host::structures::xhci_usb_device:134] assigning device into dcbaa
[ 40.521355 0:2 driver_usb::host::structures::xhci_slot_manager:21] assign device: VA:0x9019b000 to dcbaa 1
[ 40.534205 0:2 driver_usb::host::structures::xhci_usb_device:145] addressing device
[ 40.541059 0:2 driver_usb::host::structures::xhci_command_manager:82] addressing device!
[ 40.550346 0:2 driver_usb::host::structures::xhci_command_manager:107] do command AddressDevice(AddressDevice { input_context_pointer: 2417606656, block_set_address_request: false, slot_id: 1, cycle_bit: false }) !
[ 40.570571 0:2 driver_usb::host::structures::xhci_command_manager:122] waiting for interrupt handler complete!
[ 40.581769 0:2 driver_usb::host::structures::xhci_event_manager:111] event handler has a trb:CommandCompletion(CommandCompletion { completion_code: Ok(Success), command_trb_pointer: 2417578000, command_completion_parameter: 0, vf_id: 0, slot_id: 1, cycle_bit: true })
[ 40.606592 0:2 driver_usb::host::structures::xhci_event_manager:136] step into command completion.

[ 40.616921 0:2 driver_usb::host::structures::xhci_command_manager:176] handleing command complete:CommandCompletion { completion_code: Ok(Success), command_trb_pointer: 2417578000, command_completion_parameter: 0, vf_id: 0, slot_id: 1, cycle_bit: true }
[ 40.640531 0:2 driver_usb::host::structures::xhci_command_manager:128] t o t a l success!
[ 40.649905 0:2 driver_usb::host::structures::xhci_usb_device:155] addressed device at slot id 1
[ 40.659801 0:2 driver_usb::host::structures::xhci_usb_device:156] command result CommandCompletion { completion_code: Ok(Success), command_trb_pointer: 2417578000, command_completion_parameter: 0, vf_id: 0, slot_id: 1, cycle_bit: true }
[ 40.683935 0:2 driver_usb::host::structures::xhci_usb_device:282] get descriptor!
[ 40.690616 0:2 driver_usb::host::structures::xhci_usb_device:298] endpoint id: 1
[ 40.699208 0:2 driver_usb::host::structures::xhci_usb_device:309] setup stage!
[ 40.707629 0:2 driver_usb::host::structures::xhci_usb_device:262] doorbell ing
[ 40.716059 0:2 driver_usb::host::structures::xhci_event_manager:111] event handler has a trb:TransferEvent(TransferEvent { completion_code: Ok(EndpointNotEnabledError), trb_pointer: 0, trb_transfer_length: 0, event_data: false, endpoint_id: 1, slot_id: 1, cycle_bit: true })
[ 40.741479 0:2 driver_usb::host::structures::xhci_event_manager:114] event = TransferEvent { completion_code: Ok(EndpointNotEnabledError), trb_pointer: 0, trb_transfer_length: 0, event_data: false, endpoint_id: 1, slot_id: 1, cycle_bit: true }
[ 40.764221 0:2 driver_usb::host::structures::xhci_event_manager:115] step into transfer event

[ 40.774116 0:2 driver_usb::host::structures::xhci_slot_manager:47] transfer event! param: EndpointNotEnabledError,TransferEvent { completion_code: Ok(EndpointNotEnabledError), trb_pointer: 0, trb_transfer_length: 0, event_data: false, endpoint_id: 1, slot_id: 1, cycle_bit: true }
[ 40.800069 0:2 driver_usb::host::structures::xhci_slot_manager:54] failed, code:EndpointNotEnabledError
