 

arceos# test_xhci
[ 55.370323 0:2 driver_usb::host::xhci:49] resetting xhci controller
[ 55.375084 0:2 driver_usb::host::xhci:50] before reset:UsbStatusRegister { hc_halted: false, host_system_error: false, event_interrupt: false, port_change_detect: true, save_state_status: false, restore_state_status: false, save_restore_error: false, controller_not_ready: false, host_controller_error: false }
[ 55.403640 0:2 driver_usb::host::xhci:126] stop
[ 55.409370 0:2 driver_usb::host::xhci:131] wait until halt
[ 55.416053 0:2 driver_usb::host::xhci:133] halted
[ 55.421955 0:2 driver_usb::host::xhci:135] HCRST!
[ 55.427859 0:2 driver_usb::host::xhci:161] Reset xHCI Controller Globally
[ 55.435844 0:2 driver_usb::host::structures::xhci_slot_manager:65] max slot: 16
[ 55.444354 0:2 driver_usb::host::structures::xhci_slot_manager:84] initialized!
[ 55.452859 0:2 driver_usb::host::structures::xhci_slot_manager:21] assign device: VA:0x90193000 to dcbaa 0
[ 55.463707 0:2 driver_usb::host::structures::scratchpad:79] initialized!
[ 55.471607 0:2 driver_usb::host::structures::xhci_roothub:99] number of ports:2
[ 55.480111 0:2 driver_usb::host::structures::xhci_roothub:104] allocating port 0
[ 55.488707 0:2 driver_usb::host::structures:101] ----dumped port state: PortStatusAndControlRegister { current_connect_status: false, port_enabled_disabled: false, over_current_active: false, port_reset: false, port_link_state: 5, port_power: true, port_speed: 0, port_indicator_control: Off, port_link_state_write_strobe: false, connect_status_change: false, port_enabled_disabled_change: false, warm_port_reset_change: false, over_current_change: false, port_reset_change: false, port_link_state_change: false, port_config_error_change: false, cold_attach_status: false, wake_on_connect_enable: false, wake_on_disconnect_enable: false, wake_on_over_current_enable: false, device_removable: false, warm_port_reset: false }
[ 55.553111 0:2 driver_usb::host::structures::xhci_roothub:111] assert:0 == 0
[ 55.561356 0:2 driver_usb::host::structures::xhci_roothub:104] allocating port 1
[ 55.569950 0:2 driver_usb::host::structures:101] ----dumped port state: PortStatusAndControlRegister { current_connect_status: true, port_enabled_disabled: true, over_current_active: false, port_reset: false, port_link_state: 0, port_power: true, port_speed: 4, port_indicator_control: Off, port_link_state_write_strobe: false, connect_status_change: false, port_enabled_disabled_change: false, warm_port_reset_change: false, over_current_change: false, port_reset_change: true, port_link_state_change: false, port_config_error_change: false, cold_attach_status: false, wake_on_connect_enable: false, wake_on_disconnect_enable: false, wake_on_over_current_enable: false, device_removable: false, warm_port_reset: false }
[ 55.634095 0:2 driver_usb::host::structures::xhci_roothub:111] assert:1 == 1
[ 55.642340 0:2 driver_usb::host::structures::xhci_roothub:115] ended
[ 55.649893 0:2 driver_usb::host::structures::xhci_roothub:125] initialized!
[ 55.658088 0:2 driver_usb::host::structures::xhci_command_manager:252] initialized!
[ 55.666905 0:2 driver_usb::host::structures::xhci_event_manager:43] initilizating!
[ 55.675705 0:2 driver_usb::host::structures::event_ring:33] created!
[ 55.683224 0:2 driver_usb::host::structures::xhci_event_manager:56] test
[ 55.691128 0:2 driver_usb::host::structures::xhci_event_manager:99] initialized!
[ 55.699715 0:2 driver_usb::host::xhci:65] before start:UsbStatusRegister { hc_halted: true, host_system_error: false, event_interrupt: false, port_change_detect: true, save_state_status: false, restore_state_status: false, save_restore_error: false, controller_not_ready: false, host_controller_error: false }
[ 55.728186 0:2 driver_usb::host::xhci:76] init completed!, coltroller state:UsbStatusRegister { hc_halted: false, host_system_error: false, event_interrupt: false, port_change_detect: true, save_state_status: false, restore_state_status: false, save_restore_error: false, controller_not_ready: false, host_controller_error: false }
[ 55.758568 0:2 driver_usb::host::xhci:85] port0 : false
[ 55.764990 0:2 driver_usb::host::xhci:85] port1 : true
[ 55.771325 0:2 driver_usb::host::xhci:95] initializing roothub
[ 55.778356 0:2 driver_usb::host::structures::xhci_roothub:45] initializing root ports
[ 55.787383 0:2 driver_usb::host::structures::xhci_roothub:50] initializing port 0
[ 55.796066 0:2 driver_usb::host::structures::root_port:25] port 0 not connected
[ 55.804570 0:2 driver_usb::host::structures::xhci_roothub:50] initializing port 1
[ 55.813251 0:2 driver_usb::host::structures::root_port:28] port 1 connected, continue
[ 55.822277 0:2 driver_usb::host::structures:113] reseting port 1
[ 55.829483 0:2 driver_usb::host::structures:115] before reset Port 1, status: PortStatusAndControlRegister { current_connect_status: true, port_enabled_disabled: true, over_current_active: false, port_reset: false, port_link_state: 0, port_power: true, port_speed: 4, port_indicator_control: Off, port_link_state_write_strobe: false, connect_status_change: false, port_enabled_disabled_change: false, warm_port_reset_change: false, over_current_change: false, port_reset_change: true, port_link_state_change: false, port_config_error_change: false, cold_attach_status: false, wake_on_connect_enable: false, wake_on_disconnect_enable: false, wake_on_over_current_enable: false, device_removable: false, warm_port_reset: false }
[ 55.894153 0:2 driver_usb::host::structures:134] Port 1 reset ok, status: PortStatusAndControlRegister { current_connect_status: true, port_enabled_disabled: true, over_current_active: false, port_reset: false, port_link_state: 0, port_power: true, port_speed: 4, port_indicator_control: Off, port_link_state_write_strobe: false, connect_status_change: false, port_enabled_disabled_change: false, warm_port_reset_change: false, over_current_change: false, port_reset_change: true, port_link_state_change: false, port_config_error_change: false, cold_attach_status: false, wake_on_connect_enable: false, wake_on_disconnect_enable: false, wake_on_over_current_enable: false, device_removable: false, warm_port_reset: false }
[ 55.958467 0:2 driver_usb::host::structures:101] ----dumped port state: PortStatusAndControlRegister { current_connect_status: true, port_enabled_disabled: true, over_current_active: false, port_reset: false, port_link_state: 0, port_power: true, port_speed: 4, port_indicator_control: Off, port_link_state_write_strobe: false, connect_status_change: false, port_enabled_disabled_change: false, warm_port_reset_change: false, over_current_change: false, port_reset_change: true, port_link_state_change: false, port_config_error_change: false, cold_attach_status: false, wake_on_connect_enable: false, wake_on_disconnect_enable: false, wake_on_over_current_enable: false, device_removable: false, warm_port_reset: false }
[ 56.022613 0:2 driver_usb::host::structures::root_port:37] port speed: USBSpeedSuper
[ 56.031551 0:2 driver_usb::host::structures::root_port:39] initializing device: USBSpeedSuper
[ 56.041273 0:2 driver_usb::host::structures::xhci_usb_device:48] new device! port:1
[ 56.050167 0:2 axruntime::lang_items:5] panicked at crates/driver_usb/src/host/structures/context.rs:52:35:
not implemented
[ 56.062539 0:2 axhal::platform::aarch64_phytium_pi::misc:22] Shutting down...
